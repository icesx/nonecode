### 在做项目的时候，发现在通过vmware搭建的一套环境中的磁盘的IO性能比较差
1. 通过dd命令测试的磁盘的连续写的性能只能达到10-20MB/S
2. 由于裸机安装的vmware，无法测试裸机的性能
3. 但是对通过iotop测试的情况是可以达到100MB的
### 类似的配置使用的ovirt搭建的环境下测试
1. 物理机器上的磁盘持续写可以达到70MB/S
2.  虚拟机上的持续写的性能可以达到60MB/S左右
### 问题就是为何在vmware上的磁盘的性能这样的低
1. 经过沟通发现，目前使用的这个环境下的硬盘的转速为7200转，但是也不能低到持续写为20MB
2.  奇怪的是：后来没有通过LVM，在vmware中设置为“厚置备置零”的选项后，创建的磁盘读写竟然可以达到300MB。
3.  测试在“厚置备置零”的情况下，使用LVM的情况如何——LVM先创建分区表。发现并没有对性能有什么影响，大约仍然是300MB左右
4.  发现在“厚置备置零”的情况下，即使在创建LVM的时候没有先创建分区表，性能也可以达到300MB，那么基本的结论就是需要“厚置备置零”	
5.  在“厚置备置零”的情况下，7200和10000转的性能分别是，300MB，400MB
### 后和范新伟沟通后得到如下信息
1. 8×600G×15000转【目前15000转的没有大于600G的】
2.  做的raid50【raid5会降低写性能】
3.  raid卡的cache打开，并且raid卡的电池要正常
4.  能够达到的性能是持续写达到1GB/S，峰值可以达到2GB/S【万兆的交换机可以跑满】
### 在置换了Raid卡后才将问题彻底搞清楚了
1. Radi卡的缓存对于读写的性能的影响非常大，之前测试的时候使用的Raid卡为H330，这个卡是没有缓存的。
2.  在置换了H730P这个Raid卡后，性能有了显著提升【在Raid5+1WRPM的情况下，持续写可以达到1G/S，20G只需要20S左右】，不管是否是“后置备置零”
3.  在H710P的情况下，使用Raid10，性能未有明显的提升，能够达到500-700MB/S
4.  在Hadoop进行内容同步的时候，最多关闭两台机器的时候，被同步的机器的带宽可以使用到1000Mbps，磁盘可以达到400MBps
### vcenter
#### 修改IP
```
$/opt/vmware/share/vami/vami_config_net
```
#### reset
https://${ip}:5480,database, reset db contents
rm /var /lib/rdb/db